---
// src/pages/posts/[slug].astro
import "../../styles/global.css";
import Header from "../../components/Header.astro";
import Footer from "../../components/Footer.astro";
import { fetchPosts, decodeHTMLEntities } from "../../scripts/scripts.js";

// This is required for dynamic routes in Astro
export async function getStaticPaths() {
  const posts = await fetchPosts();
//@ts-ignore
  return posts.map((post) => ({
    params: { slug: post.slug },
    props: { post },
  }));
}

// Get the post directly from props since we're now passing the complete post object
const { post } = Astro.props;
---

<html>
  <head>
    <link rel="icon" type="image/svg+xml" href="/f1.svg" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <!--@ts-ignore -->
    <title>{decodeHTMLEntities(post.title)} - OnBoard Formula 1</title>
  </head>
  <body>
    <container>
      <Header />
      <main class="max-w-4xl mx-auto px-4 py-8">
        <article class="bg-white rounded-lg shadow-md overflow-hidden">
          <!--@ts-ignore -->
          <img
            src={post.imageUrl}
            alt={decodeHTMLEntities(post.title)}
            class="w-full h-64 object-cover"
          />

          <div class="p-6">
            <!--@ts-ignore -->
            <h1 class="text-3xl font-bold mb-2">
              <!--@ts-ignore -->
              {decodeHTMLEntities(post.title)}
            </h1>
            <!--@ts-ignore -->
            <div class="text-gray-500 mb-4">Published on {post.date}</div>
            <!--@ts-ignore -->
            <div class="prose max-w-none" set:html={post.content} />
          </div>
        </article>
      </main>
      <Footer />
    </container>
  </body>
</html>
